<!DOCTYPE html>
<html>
    <head>
        <title>Etch</title>
        <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
        <meta content="utf-8" http-equiv="encoding">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css" />
        <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
        <link href='http://fonts.googleapis.com/css?family=Josefin+Sans' rel='stylesheet' type='text/css'>
        <style>
            .ui-content {
                min-height: 85vh;
            }
            body,
            .ui-link {
                font-size: 1.5em;
            }
            #GPS {
                visibility: hidden;
            }
            input,
            button,
            .ui-content,
            body,
            .ui-link,
            #topBar,
            #topBar2,
            textarea,
            .ui-btn {
                font-family: 'Josefin Sans', sans-serif;
                text-shadow: none;
                color: #ffffff;
            }
            .ui-corner-all, .ui-btn.ui-corner-all {
                -webkit-border-radius: 0;
                border-radius: 0;
            }
            #header {
                height: 10vh;
                background-color: transparent;
                border: none;
            }
            #rightBtn,
            #leftBtn {
                position: absolute;
                top: 0;
                height: 10vh;
                width: 10vh;
                padding: 0;
                border-radius: 0;
                background: none;
                text-shadow: none;
                border: none;
                box-shadow: none;
            }
            #leftBtn {
                left: 0;
            }
            #rightBtn {
                right: 0;
            }
            #headlineID{
                border-radius: 0;
                border: none;
            }
            .ui-content {
                position: relative;
                border-style: solid;
            }
            .fullscreen-img {
                z-index: 0;
                height: 90vh;
                background-repeat: no-repeat;
                background-position: center top;
                background-size: cover;
            }
            ul {
                list-style-type: none;
            }
            li {
                padding: 1vh;
                height: 10vh;
                width: 10vh;
            }
            ul li svg {
                height: 7vh;
            }
            input{
                margin-left: 0;
            }
            .ui-mobile label{
                background-color: #0086b2;
                margin-right:0;
                min-height: 2.2em;
            }
            #etchSelector {
                position: fixed;
                right: 1vh;
                bottom: 0px;
                top: 20vh;
            }
            #etchsContainer {
                /*            width: 90vh;*/
                margin-top: 70vh;
            }
            #headerBarFind,
            #headerBarEtch {
                position: absolute;
                z-index: -1;
            }
            #headerBarFind {
                left: -10vh;
            }
            #headerBarEtch {
                right: -10vh;
            }
            #etch {
                background: none;
            }
            .pageTitle {
                text-shadow: none;
            }
            #etchBackground {
                position: absolute;
                background: rgba(0, 0, 0, 1);
                width: 100vw;
                top: 100vh;
                height: 100%;
            }
            .navIcon {
                display: block;
                margin: 0 auto;
                height: 7vh;
                margin-top: 1.5vh;
            }
            #gradient {
                width: 100vw;
                top: 0;
                height: 100%;
                position:absolute;

                background: -moz-linear-gradient(top,  rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.3) 59%, rgba(0,0,0,1) 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(0,0,0,0.1)), color-stop(59%,rgba(0,0,0,0.3)), color-stop(100%,rgba(0,0,0,1))); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top,  rgba(0,0,0,0.1) 0%,rgba(0,0,0,0.3) 59%,rgba(0,0,0,1) 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top,  rgba(0,0,0,0.1) 0%,rgba(0,0,0,0.3) 59%,rgba(0,0,0,1) 100%); /* Opera 11.10+ */
                background: -ms-linear-gradient(top,  rgba(0,0,0,0.1) 0%,rgba(0,0,0,0.3) 59%,rgba(0,0,0,1) 100%); /* IE10+ */
                background: linear-gradient(to bottom,  rgba(0,0,0,0.1) 0%,rgba(0,0,0,0.3) 59%,rgba(0,0,0,1) 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#26000000', endColorstr='#000000',GradientType=0 ); /* IE6-9 */



            }
            .ui-btn {
                color: #ffffff;
            }
            .rotating {
                -webkit-transition: all 0.3s ease-in-out;
                -moz-transition: all 0.3s ease-in-out;
                -o-transition: all 0.3s ease-in-out;
                transition: all 0.3s ease-in-out;
            }
            .rotated {
                transform: rotate(45deg);
                -webkit-transform: rotate(45deg);
                -moz-transform: rotate(45deg);
                -o-transform: rotate(45deg);
            }
            .blue rect{
                fill: #0086b2;
            }
        </style>
    </head>

    <body>
        <!-- Start of first page -->
        <div data-role="page" id="find" class="fullscreen-img" style="background-image: url(../public/image/image4.jpg);">
            <div id="header" data-role="header" data-id="persistent" data-position="fixed" data-tap-toggle="false">
                <svg id="headerBarFind" xmlns="http://www.w3.org/2000/svg" height="100%" width="100%">
                    <rect width="100%" height="100%" style="fill: #0086b2" />
                </svg>
                <h1 class="pageTitle">otherEtchings</h1>
                <a href="#etch" id="leftBtn" data-transition="slide" data-direction="reverse">
                    <img class="navIcon" src="../public/images/+.svg">
                </a>
                <a href="#" id="rightBtn">
                    <img class="navIcon" src="../public/images/+.svg">
                </a>
            </div>
            <!-- /header -->
            <div id="gradient"></div>
            <div id="etchBackground"></div>
            <!-- Story pages -->
            <div role="main" class="ui-content" id="mainpage">
                <div id="etchsContainer">
                    <div class="etchContent" id="etch1">
                        <div id="result1">
                            <h1><%= headline1 %></h1>
    <!--                        <h1>Lorem Ipsum</h1>-->
                        </div>
                        <div id="result2">
                            <h2><%= author1 %></h2>
    <!--                        <h2>Neque porro quisquam </h2>-->
                        </div>
                        <div id="result3">
                            <p><%= story1 %></p>
    <!--                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis consequat aliquet augue vel viverra. Quisque aliquam, massa non tempus varius, urna enim condimentum elit, non interdum augue ligula sit amet dolor. Ut ultricies feugiat viverra. Cras nunc libero, mollis ut porttitor condimentum, iaculis ac libero. Maecenas porttitor lorem sit amet ornare adipiscing. Nullam ac malesuada metus. Curabitur a rutrum eros, id condimentum libero. Nam in porta ipsum, faucibus commodo nunc. Integer sed nibh enim. Curabitur dui elit, scelerisque nec arcu in, consequat fermentum dui. Nulla facilisi.</p>-->
                        </div>

                        <div class="etchContent" id="etch2" style="display:none">
                            <div id="result4">
                                <h1><%= headline2 %></h1>
                            </div>
                            <div id="result5">
                                <h2><%= author2 %></h2>
                            </div>
                            <div id="result6">
                                <p>
                                    <%= story2 %>
                                </p>
                            </div>
                        </div>

                        <div class="etchContent" id="etch3" style="display:none">
                            <div id="result7">
                                <h1><%= headline3 %></h1>
                            </div>
                            <div id="result8">
                                <h2><%= author3 %></h2>
                            </div>
                            <div id="result9">
                                <p>
                                    <%= story3 %>
                                </p>
                            </div>
                        </div>

                        <div class="etchContent" id="etch4" style="display:none">
                            <div id="result10">
                                <h1><%= headline4 %></h1>
                            </div>
                            <div id="result11">
                                <h2><%= author4 %></h2>
                            </div>
                            <div id="result12">
                                <p>
                                    <%= story4 %>
                                </p>
                            </div>
                        </div>

                        <div class="etchContent" id="etch5" style="display:none">
                            <div id="result13">
                                <h1><%= headline5 %></h1>
                            </div>
                            <div id="result14">
                                <h2><%= author5 %></h2>
                            </div>
                            <div id="result15">
                                <p>
                                    <%= story5 %>
                                </p>
                            </div>
                        </div>
                        <!-- /Story pages -->
                    </div>

                    <div id="etchSelector">
                        <ul id="etchSelectorBtns">
                            <li>
                                <a id="btn1" href="#etch1">
                                    <svg class="rotating rotated blue" viewbox="0 0 64 64">
                                        <rect x="24" y="0" transform="matrix(0.7071 0.7071 -0.7071 0.7071 32 -13.2548)" fill="#FFFFFF" width="16" height="64" />
                                        <rect x="24" y="0" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 77.2548 32)" fill="#FFFFFF" width="16" height="64" />
                                    </svg>
                                </a>
                            </li>
                            <li>
                                <a id="btn2" href="#etch2">
                                    <svg class="rotating" viewbox="0 0 64 64">
                                        <rect x="24" y="0" transform="matrix(0.7071 0.7071 -0.7071 0.7071 32 -13.2548)" fill="#FFFFFF" width="16" height="64" />
                                        <rect x="24" y="0" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 77.2548 32)" fill="#FFFFFF" width="16" height="64" />
                                    </svg>
                                </a>
                            </li>
                            <li>
                                <a id="btn3" href="#etch3">
                                    <svg class="rotating" viewbox="0 0 64 64">
                                        <rect x="24" y="0" transform="matrix(0.7071 0.7071 -0.7071 0.7071 32 -13.2548)" fill="#FFFFFF" width="16" height="64" />
                                        <rect x="24" y="0" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 77.2548 32)" fill="#FFFFFF" width="16" height="64" />
                                    </svg>
                                </a>
                            </li>
                            <li>
                                <a id="btn4" href="#etch4">
                                    <svg class="rotating" viewbox="0 0 64 64">
                                        <rect x="24" y="0" transform="matrix(0.7071 0.7071 -0.7071 0.7071 32 -13.2548)" fill="#FFFFFF" width="16" height="64" />
                                        <rect x="24" y="0" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 77.2548 32)" fill="#FFFFFF" width="16" height="64" />
                                    </svg>
                                </a>
                            </li>
                            <li>
                                <a id="btn5" href="#etch5">
                                    <svg class="rotating" viewbox="0 0 64 64">
                                        <rect x="24" y="0" transform="matrix(0.7071 0.7071 -0.7071 0.7071 32 -13.2548)" fill="#FFFFFF" width="16" height="64" />
                                        <rect x="24" y="0" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 77.2548 32)" fill="#FFFFFF" width="16" height="64" />
                                    </svg>
                                </a>
                            </li>
                        </ul>
                    </div>


                    <!--div id="result4"><img src=./public/image/<%= image %> /></div-->
                    <!--            <input type="submit" value="Change story" id="change" data-icon="star" data-iconpos="right" />-->
                </div>
                <!-- /content -->
            </div>
            <!-- /page -->


            <!-- Start of second page -->
            <div data-role="page" id="etch">
                <div id="imgTint"></div>
                <div data-role="header" id="header" data-id="persistent" data-position="fixed" data-tap-toggle="false">
                    <svg id="headerBarEtch" xmlns="http://www.w3.org/2000/svg" height="100%" width="100%">
                        <rect width="100%" height="100%" style="fill: #0086b2" />
                    </svg>

                    <h1 class="pageTitle">Etch</h1>
                    <a href="#" id="leftBtn">
                        <img src="../public/images/+.svg" class="navIcon">
                    </a>
                    <a href="#find" id="rightBtn" data-transition="slide">
                        <img class="navIcon" src="../public/images/+.svg">
                    </a>
                </div>
                <!--header-->
                <div role="main" class="ui-content">

                    <form method="post" enctype="multipart/form-data" action="/base/upload" data-ajax="false">
                        <div class="ui-field-contain">
                            <label for="text-2">Headline:</label>
                            <input type="text" name="headline" placeholder="Headline" id="headlineID">
                        </div>
                        <br>
                         <div class="ui-field-contain">
                        <label for="text-2">Author:</label>
                        <input type="text" name="author" placeholder="Author (Optional)" id="authorID">
                        </div>
                        <br>
                         <div class="ui-field-contain">
                        <label for="text-2">Etching:</label>
        <!--                <input type="text" name="etching" placeholder="Your Etching" id="story">-->
                        <textarea cols="40" rows="8" name="etching" placeholder="Your Etching" id="story"></textarea>
                        </div>
                        <br>
                        <div style="height:0px;overflow:hidden">
                            <input type="file" id="fileInput" name="fileInput" />
                        </div>
                        <button type="button" onclick="chooseFile();">Choose an image</button>
                        <br>


                        <input type="hidden" name="latitude" id="lat" />
                        <input type="hidden" name="longitude" id="lng" />
                        <input type="submit" value="Submit your story" id="submitButton" data-icon="plus" data-iconpos="right" />
                    </form>
                </div>
                <!-- /content -->
            </div>
            <!-- /page -->

                <script type="text/javascript">
            $(document).bind('pageinit', function () {
                $.ajaxSetup({
                    cache: false
                });

                navigator.geolocation.getCurrentPosition(function (pos) {
                    var lat = pos.coords.latitude;
                    var lng = pos.coords.longitude;
                    $("#lat").val(lat);
                    $("#lng").val(lng);
                });

                /*$( "#submitButton" ).bind( "click", function(event, ui) {
                        var jsonUrl = "http://localhost:3000/submit";
                        var story = { 
                            "headline" : $("#headlineID").val(), 
                            "author" : $("#authorID").val (), 
                            "etching" : $("#story").val (),
                            "latitude" : $("#lat").val(), 
                            "longitude" : $("#lng").val(), 
                        };

                        $.post(jsonUrl,story, function(data) {
                            alert("Story is added");
                            location.reload();
                        }, 'json');
                    });*/

                $("#change").bind("click", function (event, ui) {
                    var jsonUrl = "http://rocky-hamlet-2798.herokuapp.com/base/change";

                    $.get(jsonUrl, function (data) {
                        $("#result1").html("<h1>" + data.headline + "</h1>")
                        $("#result2").html("<h2>" + data.author + "</h2>")
                        $("#result3").html("<p>" + data.story + "</p>");

                        //$("#result4").html("<img src=../public/image/"+data.image+">" + "</img>");
                        var image = $('#mainpage');
                        image.css('background-image', 'url(/public/image/' + data.image + ')');
                    }, 'json');
                });
            });


             // Story navigation buttons
            $(document).ready(function () {
                var etchHeight = $("#etch1").height();
                $("#etchBackground").css("height", etchHeight);

                $("#btn1").click(function () {
                    $("#etch1").show();
                    $("#etch2").hide();
                    $("#etch3").hide();
                    $("#etch4").hide();
                    $("#etch5").hide();

                    var btnImg = $("#btn1 .rotating");
                    $(".rotated").attr("class", "rotating");
                    btnImg.attr("class", "rotating rotated blue");

                    var etchHeight = $("#etch1").height();
                    $("#etchBackground").css("height", etchHeight);
                });

                $("#btn2").click(function () {
                    $("#etch2").show();
                    $("#etch1").hide();
                    $("#etch3").hide();
                    $("#etch4").hide();
                    $("#etch5").hide();

                    var btnImg = $("#btn2 .rotating");
                    $(".rotated").attr("class", "rotating");
                    btnImg.attr("class", "rotating rotated blue");

                    var etchHeight = $("#etch2").height();
                    $("#etchBackground").css("height", etchHeight);
                });

                $("#btn3").click(function () {
                    $("#etch3").show();
                    $("#etch2").hide();
                    $("#etch1").hide();
                    $("#etch4").hide();
                    $("#etch5").hide();

                    var btnImg = $("#btn3 .rotating");
                    $(".rotated").attr("class", "rotating");
                    btnImg.attr("class", "rotating rotated blue");

                    var etchHeight = $("#etch3").height();
                    $("#etchBackground").css("height", etchHeight);
                });

                $("#btn4").click(function () {
                    $("#etch4").show();
                    $("#etch2").hide();
                    $("#etch3").hide();
                    $("#etch1").hide();
                    $("#etch5").hide();

                    var btnImg = $("#btn4 .rotating");
                    $(".rotated").attr("class", "rotating");
                    btnImg.attr("class", "rotating rotated blue");

                    var etchHeight = $("#etch4").height();
                    $("#etchBackground").css("height", etchHeight);
                });

                $("#btn5").click(function () {
                    $("#etch5").show();
                    $("#etch2").hide();
                    $("#etch3").hide();
                    $("#etch4").hide();
                    $("#etch1").hide();

                    var btnImg = $("#btn5 .rotating");
                    $(".rotated").attr("class", "rotating");
                    btnImg.attr("class", "rotating rotated blue");

                    var etchHeight = $("#etch5").height();
                    $("#etchBackground").css("height", etchHeight);
                });


                // Calculating widths of story and the navigation
                var viewHeight;
                var viewWidth;
                if (typeof window.innerWidth != undefined) {
                    viewHeight = window.innerHeight;
                    viewWidth = window.innerWidth;
                    document.getElementById("etchsContainer").style.width = viewWidth - (0.18 * viewHeight) + 'px';
                }

            });


            // Swiping to navigate between pages
            $(document).on('swiperight','#find', function()
                { $.mobile.changePage("#etch"); });
            $(document).on('swipeleft','#etch', function()
                { $.mobile.changePage("#find"); });


            // For the upload page, formatting of the choose file button
            function chooseFile() {
                $("#fileInput").click();
            }
        </script>
    </body>
</html>


